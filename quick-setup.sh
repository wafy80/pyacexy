#!/bin/bash

# Quick Setup Guide per pyacexy
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘  PyAcexy - Quick Setup Guide                                   â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Check if we're in the right directory
if [ ! -f "setup.py" ]; then
    echo "âŒ Errore: Esegui questo script da /home/wafy/src/acexy/pyacexy"
    exit 1
fi

echo "ğŸ“ Posizione: $(pwd)"
echo "ğŸ“¦ Progetto: pyacexy - Python AceStream Proxy"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ¯ PASSI PER LA PUBBLICAZIONE SU GITHUB"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

echo "1ï¸âƒ£  CREA IL REPOSITORY SU GITHUB"
echo ""
echo "   Apri nel browser:"
echo "   ğŸ‘‰ https://github.com/new"
echo ""
echo "   Compila il form:"
echo "   â€¢ Repository name: pyacexy"
echo "   â€¢ Description: Python implementation of AceStream HTTP proxy"
echo "   â€¢ Public âœ“"
echo "   â€¢ âŒ NON aggiungere README, .gitignore, o license"
echo "   â€¢ Click 'Create repository'"
echo ""
read -p "   âœ“ Fatto? Premi INVIO per continuare..." dummy
echo ""

echo "2ï¸âƒ£  CONFIGURA LE CREDENZIALI (Scegli un metodo)"
echo ""
echo "   Opzione A - Personal Access Token (RACCOMANDATO):"
echo "   1. Vai su: https://github.com/settings/tokens/new"
echo "   2. Note: 'pyacexy deployment'"
echo "   3. Scadenza: 30 giorni (o a piacere)"
echo "   4. Seleziona: [âœ“] repo"
echo "   5. Click 'Generate token'"
echo "   6. COPIA IL TOKEN (lo vedrai solo una volta!)"
echo ""
echo "   Opzione B - SSH Key (per uso futuro):"
echo "   â€¢ Segui: https://docs.github.com/en/authentication/connecting-to-github-with-ssh"
echo ""
read -p "   Premi INVIO quando sei pronto per il push..." dummy
echo ""

echo "3ï¸âƒ£  PUSH DEL CODICE"
echo ""
echo "   Eseguo: git push -u origin main"
echo ""
echo "   ğŸ”‘ Quando richiesto:"
echo "   â€¢ Username: wafy80"
echo "   â€¢ Password: [INCOLLA IL TOKEN]"
echo ""
read -p "   Premi INVIO per procedere con il push..." dummy

# Execute push
git push -u origin main

if [ $? -eq 0 ]; then
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "âœ… SUCCESSO! Repository pubblicato!"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
    echo "ğŸŒ Repository: https://github.com/wafy80/pyacexy"
    echo "ğŸ”§ Actions: https://github.com/wafy80/pyacexy/actions"
    echo "ğŸ“¦ Packages: https://github.com/wafy80/pyacexy/pkgs/container/pyacexy"
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
    echo "ğŸ“‹ PROSSIMI PASSI:"
    echo ""
    echo "  1. Verifica che le GitHub Actions funzionino"
    echo "  2. Crea una release:"
    echo "     git tag -a v0.1.0 -m 'Initial release'"
    echo "     git push origin v0.1.0"
    echo ""
    echo "  3. Test installazione:"
    echo "     pip install git+https://github.com/wafy80/pyacexy.git"
    echo ""
    echo "  4. Opzionale - Pubblica su PyPI:"
    echo "     pip install build twine"
    echo "     python -m build"
    echo "     twine upload dist/*"
    echo ""
else
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "âŒ Push fallito!"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
    echo "ğŸ” Possibili cause:"
    echo ""
    echo "  1. Repository non ancora creato su GitHub"
    echo "     â†’ Vai su https://github.com/new e crealo"
    echo ""
    echo "  2. Credenziali errate"
    echo "     â†’ Usa un Personal Access Token come password"
    echo "     â†’ https://github.com/settings/tokens"
    echo ""
    echo "  3. Permessi insufficienti"
    echo "     â†’ Il token deve avere scope 'repo'"
    echo ""
    echo "ğŸ“– Per maggiori info: cat DEPLOYMENT_GUIDE.md"
    echo ""
fi
